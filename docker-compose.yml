name: riparr

services:
  app:
    build: .
    container_name: riparr
    ports:
      - "5000:5000"
    environment:
      - PORT=5000
      - SECRET_KEY=change-this-in-production
      - DATABASE_URL=sqlite:////app/data/riparr.db
      - JELLYFIN_URL=${JELLYFIN_URL:-}
      - JELLYFIN_API_KEY=${JELLYFIN_API_KEY:-}
      - PRIMARY_STREAMING_SERVICE=${PRIMARY_STREAMING_SERVICE:-qobuz}
      - FALLBACK_STREAMING_SERVICE=${FALLBACK_STREAMING_SERVICE:-deezer}
      - MUSIC_OUTPUT_PATH=/media/Music
    volumes:
      - riparr-data:/app/data
      - jellyfin-media:/media
      - ${CONFIG_PATH:-./config}:/app/config
    # restart: unless-stopped

  # jellyfin:
  #   container_name: jellyfin
  #   volumes:
  #     - jellyfin-config:/config
  #     - jellyfin-cache:/cache
  #     - jellyfin-media:/media
  #   # network_mode: host
  #   ports:
  #     - "8096:8096" # Expose Jellyfin port to the host
  #   image: jellyfin/jellyfin:10.10.7

volumes:
  riparr-data:
  jellyfin-config:
  jellyfin-cache:
  jellyfin-media: